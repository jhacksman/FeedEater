- name: Check Docker availability
  ansible.builtin.command:
    cmd: docker --version
  register: docker_version
  changed_when: false
  failed_when: false

- name: Check Docker Compose availability
  ansible.builtin.command:
    cmd: docker compose version
  register: docker_compose_version
  changed_when: false
  failed_when: false

- name: Install Docker (Debian/Ubuntu) if missing
  ansible.builtin.apt:
    name:
      - docker.io
      - docker-compose-plugin
    state: present
    update_cache: true
  when: docker_version.rc != 0 or docker_compose_version.rc != 0

- name: Ensure docker service is running
  ansible.builtin.service:
    name: docker
    state: started
    enabled: true


